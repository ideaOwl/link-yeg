this.originalRoute=Backbone.Router.prototype.route,_.extend(Backbone.Router.prototype,this,{beforeAllFilters:[],runFilters:function(route,callback){var filters=this.beforeAllFilters(),proceed=!0;for(i=0;i<filters.length&&(proceed=filters[i].call(this,route,callback),proceed);i++);return proceed},route:function(route,name,callback){return _.isRegExp(route)||(route=this._routeToRegExp(route)),callback||(callback=this[name]),Backbone.history.route(route,_.bind(function(fragment){if(this.runFilters(route,callback)){var args=this._extractParameters(route,fragment);callback&&callback.apply(this,args),this.trigger.apply(this,["route:"+name].concat(args)),Backbone.history.trigger("route",this,name,args)}},this)),this}});