(function($,doc){var $doc=$(doc),mousedown=false,wait=false;var template='    <div class="ui-switch">                                 \n      <div class="ui-switch-mask">                          \n        <div class="ui-switch-master">                      \n          <div class="ui-switch-upper">                     \n            <span class="ui-switch-handle"></span>          \n          </div>                                            \n          <div class="ui-switch-lower">                     \n            <div class="ui-switch-labels">                  \n              <a href="#" class="ui-switch-on">{{on}}</a>   \n              <a href="#" class="ui-switch-off">{{off}}</a> \n            </div>                                          \n          </div>                                            \n        </div>                                              \n      </div>                                                \n      <div class="ui-switch-middle"></div>                  \n    </div>';$doc.bind("mousedown",function(e){if(e.which<=1&&!e.metaKey&&!e.shiftKey&&!e.altKey&&!e.ctrlKey){mousedown=true}}).bind("mouseup",function(e){mousedown=false});$doc.bind("mouseup touchend",function(){wait=false;if($(".ui-switch[data-dragging]").length>0){$(".ui-switch[data-dragging]").data("controls").snap();wait=true}});var switchify={build:function($select,options){$select.hide();$select.attr("tabindex","-1");var opts=$select.find("option"),val=$select.val(),disabled=!!$select.attr("disabled");var values={on:options.on||opts.first().val(),off:options.off||opts.last().val()},text={on:opts.filter("[value="+values.on+"]").text(),off:opts.filter("[value="+values.off+"]").text()};var $switch=$(template.replace("{{on}}",text.on).replace("{{off}}",text.off));$switch.addClass($select.val()===values.on?"on":"off");if(disabled){$switch.addClass("disabled")}var $master=$switch.find(".ui-switch-master"),$handle=$switch.find(".ui-switch-handle");$switch.insertAfter($select);var linkWidths=$switch.find("a").map(function(i,a){return $(a).width()}),labelMaxWidth=Math.max(linkWidths[0],linkWidths[1]);$switch.find(".ui-switch-middle").width(labelMaxWidth+43);$switch.find("a").width(labelMaxWidth);var masterOff="-"+(labelMaxWidth+21)+"px",masterOn="-2px";$master.css({left:masterOff});$handle.css({left:labelMaxWidth+16+"px"});if(values.on===val){$master.css({left:masterOn})}$select.data("switch",$switch);$switch.data("select",$select);$switch.data("animating",false);$switch.data("offset",$switch.offset()).data("dimensions",{width:$switch.width(),height:$switch.height()}).data("center",{left:$switch.data("offset").left+$switch.data("dimensions").width/2,top:$switch.data("offset").top+$switch.data("dimensions").height/2});$.event.special["switch:slide"]={_default:function(e,type){var $switch=$(e.target);if(!type&&$switch.data("switchEvent")){type=$switch.data("switchEvent");$switch.removeData("switchEvent")}if(!(type==="on"||type==="off")){throw'jQuery/Switch: "switch:slide" event must be triggered with an additional parameter of "on" or "off"'}$switch.trigger("switch:slide"+type)}};var controls=$switch.data("controls",{_to:function(type,options){if(!options){options={silent:false}}if(!disabled&&!options.silent){$switch.data("switchEvent",type);$switch.trigger("switch:slide",[type])}else if(!disabled){$switch.trigger("switch:slide"+type)}return $switch},on:function(opts){return controls._to("on",opts)},off:function(opts){return controls._to("off",opts)},toggle:function(opts){return controls._to($select.val()===values.on?"off":"on",opts)},snap:function(opts){if(!opts){opts={}}if(!$switch.data("animating")&&$switch.attr("data-dragging")){if($switch.find(".ui-switch-handle").offset().left+15>$switch.data("center").left){opts.silent=$switch.data("select").val()==values.on;return controls.on(opts)}else{opts.silent=$switch.data("select").val()==values.off;return controls.off(opts)}}else{return $switch}}})&&$switch.data("controls");$select.bind("change",function(){mousedown=false;controls[$select.val()===values.on?"on":"off"]()});$switch.attr("tabindex","0").bind("keyup",function(e){if(e.which===13){controls.toggle()}});$switch.find("a").attr("tabindex","-1");$switch.bind("mouseup touchend",function(e){e.preventDefault();if(!$switch.attr("data-dragging")){controls.toggle()}});$switch.bind("mousedown touchstart",function(e){e.preventDefault();var pageX,pageY;if(e.type==="touchstart"){pageX=e.originalEvent.targetTouches[0].pageX;pageY=e.originalEvent.targetTouches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}var masterLeft=parseInt($master.css("left")),masterOffsetLeft=$switch.data("offset").left+masterLeft,modifier=masterOffsetLeft-pageX;$switch.data("modifier",modifier)});$switch.bind("mouseleave touchcancel",function(e){if(!wait){$switch.data("controls").snap()}else{wait=false}});$switch.bind("mousemove touchmove",function(e){e.preventDefault();if(!disabled&&(e.type==="touchmove"||mousedown)){$switch.attr("data-dragging","true");var pageX,pageY;if(e.type==="touchmove"){pageX=e.originalEvent.targetTouches[0].pageX;pageY=e.originalEvent.targetTouches[0].pageY}else{pageX=e.pageX;pageY=e.pageY}var offset=$switch.data("offset"),dimensions=$switch.data("dimensions"),center=$switch.data("center");var newOffset=pageX+$switch.data("modifier"),currentOffset=offset.left-(labelMaxWidth+35);if(newOffset>currentOffset+18&&newOffset<=currentOffset-19+dimensions.width){$master.offset({left:newOffset})}}});$switch.bind("switch:slideon",function(){$switch.data("animating",true).removeAttr("data-dragging");$master.stop().animate({left:masterOn},"fast",function(){$switch.data("animating",false).data("select").val(values.on);$switch.removeClass("off").addClass("on");$switch.trigger("switch:slide-complete");mousedown=false;wait=false})});$switch.bind("switch:slideoff",function(){$switch.data("animating",true).removeAttr("data-dragging");$master.stop().animate({left:masterOff},"fast",function(){$switch.data("animating",false).data("select").val(values.off);$switch.removeClass("on").addClass("off");$switch.trigger("switch:slide-complete");mousedown=false;wait=false})});return $select},update:function($select){var $switch=$select.data("switch");$switch.data("offset",$switch.offset()).data("dimensions",{width:$switch.width(),height:$switch.height()}).data("center",{left:$switch.data("offset").left+$switch.data("dimensions").width/2,top:$switch.data("offset").top+$switch.data("dimensions").height/2});return $select}};$.fn.switchify=function(arg){this.each(function(i,select){var $select=$(select);if(arg!=="update"&&$select.data("switch")){return}switchify[arg==="update"?"update":"build"]($select,arg||{})});return this}})(jQuery,window.document);